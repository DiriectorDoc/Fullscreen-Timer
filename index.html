<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content="Fullscreen timer" />
		<meta name="author" content="Diriector_Doc" />
		<meta name="last-updated" content="Sun, 28 Nov 2021 20:44 GMT" />
		<meta name="keywords" content="diriector_doc, diriectordoc, diriector doc, timer" />
		<title>Fullscreen Timer</title>
		<link rel="icon" />
		<link href="../global.css" rel="stylesheet" type="text/css">
		<script type="text/javascript" src="../global.js"></script>
		<style>
			@media (prefers-color-scheme: light) {
				#container {
					background: #FFF;
					color: #000;
				}

				#output {
					fill: black;
				}

				#start-button {
					background: #FFF;
					border: solid #000 2px;
					color: #000;
				}

				#start-button:hover {
					background: #000;
					color: #FFF;
				}
			}

			@media (prefers-color-scheme: dark) {
				#container {
					background: #000;
					color: #FFF;
				}

				#output {
					fill: white;
				}

				#start-button {
					background: #000;
					border: solid #FFF 2px;
					color: #FFF;
				}

				#start-button:hover {
					background: #FFF;
					color: #000;
				}
			}

			@media only screen and (min-width: 400px) {
				.instructions {
					padding: 0 6rem
				}
			}

			@media only screen and (max-width: 400px) {
				.instructions {
					padding: 0 3rem
				}
			}

			* {
				font-family: sans-serif;
			}

			body {
				margin: 0;
			}

			.centre-content {
				align-items: center;
				display: flex;
			}

			.copyright {
				bottom: 15px;
				position: absolute;
				right: 15px;
			}

			.cursor-pointer * {
				cursor: pointer;
			}

			.github {
				left: 15px;
				position: absolute;
				top: 15px;
			}

			.instructions {
				line-height: 2em;
				text-align: center;
			}

			.license {
				bottom: 15px;
				left: 15px;
				position: absolute;
			}

			#container div {
				flex: 0 1 auto;
				font-size: 1.5rem;
			}

			#container {
				align-content: center;
				align-items: center;
				display: flex;
				flex-direction: column;
				flex-wrap: wrap;
				height: 100vh;
				justify-content: center;
				width: 100vw;
			}

			#holder {
				height: 100%;
				width: 100%;
			}

			#output {
				font-family: monospace;
				
			}

			#overlay {
				height: 100vh;
				pointer-events: none;
				position: absolute;
				width: 100%;
			}

			#overlay * {
				pointer-events: all;
			}

			#start-button {
				border-radius: .75rem;
				font-size: 1.5rem;
				padding: .75rem 1.25rem;
				text-decoration: none;
				transition: 100ms ease-in;
			}
		</style>
		<script>
			window.onload = () => {
				let time, running = true, len = 0;
					
				const $id = (id) => document.getElementById(id),
					container = $id("container"),
					newElem = (tag, id) => (tag = document.createElement(tag), tag.id = id, tag),
					newShape = (tag, id) => (tag = document.createElementNS("http://www.w3.org/2000/svg", tag), tag.id = id, tag),

					printTime = (newTime) => {
						let diff = newTime - time,
							h = `${Math.trunc(diff / 36e5)}`,
							m = `${Math.trunc(diff / 60000) - h*60}`,
							s = `${Math.trunc(diff / 1000) - m*60 - h*3600}`,
							ms = `${diff - s*1000 - m*60000 - h*36e5}`;
						if(h > 0 && m.length == 1){
							m = `0${m}`
						}
						if(s.length == 1){
							s = `0${s}`
						}
						while(ms.length < 3){
							ms = `0${ms}`
						}
						out.innerHTML = `${h}h ${m}m ${s}s ${ms}ms`;
						if(out.innerHTML.length != len){
							let bbox = svg.getBBox();
							svg.setAttribute("viewBox", `0 0 ${bbox.width} ${bbox.height}`)
							len = out.innerHTML.length
						}
					},
					
					svg = newShape("svg", "holder"),
					out = newShape("text", "output"),
					loop = () => {
						printTime(Date.now())
						if(running)requestAnimationFrame(loop)
					},
					stop = (stop) => {
						running = false
						printTime(stop)
						document.removeEventListener("mousedown", docClick)
						document.removeEventListener("keydown", docSpace)
						container.classList.remove("cursor-pointer")
					},
					docClick = (e) => {
						stop(Date.now())
						e.preventDefault()
					},
					docSpace = (e) => {
						if(e.code == "Space"){
							stop(Date.now())
							e.preventDefault()
						}
					};
				
				out.setAttribute("dominant-baseline", "middle")
				out.setAttribute("y", "50%")
				svg.append(out)
				$id("start-button").addEventListener("click", (e) => {
					time = Date.now();
					$id("overlay").remove()
					container.replaceChildren(svg)
					container.classList.add("centre-content", "cursor-pointer")
					loop()
					document.addEventListener("mousedown", docClick)
					document.addEventListener("keydown", docSpace)
				})
			}
		</script>
	</head>
	<body>
		<div id="overlay">
			<a class="github"></a>
			<div class="license mit"></div>
			<div class="copyright">v1.0 â€” D_Doc, 2021</div>
		</div>
		<div id="container">
			<div class="instructions">
				Press START to start the timer. To stop the timer, press your spacebar or click/tap anywhere.
			</div>
			<div>
				<button id="start-button">START</button>
			</div>
		</div>
	</body>
</html>